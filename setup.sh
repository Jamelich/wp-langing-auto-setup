#!/bin/bash
# ============================================
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ WordPress
# –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: https://github.com/Jamelich/wp-langing-auto-setup
# ============================================

set -e  # –ü—Ä–µ—Ä—ã–≤–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–∏ –ª—é–±–æ–π –æ—à–∏–±–∫–µ

echo "üöÄ –ù–∞—á–∏–Ω–∞—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é —É—Å—Ç–∞–Ω–æ–≤–∫—É WordPress..."
echo "============================================="

# –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –ë–õ–û–ö: –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø–∞–ø–∫–∏ (–∫—Ä–æ–º–µ —Å–∞–º–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞)
echo "üßπ –û—á–∏—â–∞—é —Ä–∞–±–æ—á—É—é –ø–∞–ø–∫—É –æ—Ç —Å—Ç–∞—Ä—ã—Ö —Ñ–∞–π–ª–æ–≤..."
find . -maxdepth 1 ! -name 'setup.sh' ! -name '.' ! -name '..' -exec rm -rf {} + 2>/dev/null || true
echo "‚úÖ –ü–∞–ø–∫–∞ –æ—á–∏—â–µ–Ω–∞"

# 1. –£–°–¢–ê–ù–û–í–ö–ê WORDPRESS
echo "üì¶ –°–∫–∞—á–∏–≤–∞—é –∏ —Ä–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞—é WordPress..."
wget -q https://wordpress.org/latest.tar.gz
tar -xzf latest.tar.gz --strip-components=1
rm -f latest.tar.gz
echo "‚úÖ WordPress —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"

# 2. –£–°–¢–ê–ù–û–í–ö–ê –ü–õ–ê–ì–ò–ù–û–í
echo "üîå –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é –ø–ª–∞–≥–∏–Ω—ã..."
cd wp-content/plugins/
echo "   üìÇ –¢–µ–∫—É—â–∞—è –ø–∞–ø–∫–∞: $(pwd)"

PLUGINS=("wordpress-seo" "contact-form-7")
DOWNLOADED_ZIPS=()

for plugin in "${PLUGINS[@]}"; do
    echo "   üì• –ó–∞–≥—Ä—É–∂–∞—é ${plugin}..."
    if wget -q "https://downloads.wordpress.org/plugin/${plugin}.latest-stable.zip"; then
        DOWNLOADED_ZIPS+=("${plugin}.latest-stable.zip")
    else
        echo "   ‚ùå –û–®–ò–ë–ö–ê: –Ω–µ —É–¥–∞–ª–æ—Å—å —Å–∫–∞—á–∞—Ç—å ${plugin}"
        echo "   üí° –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø –∫ downloads.wordpress.org –∏–ª–∏ –∏–º—è –ø–ª–∞–≥–∏–Ω–∞"
    fi
done

if [ ${#DOWNLOADED_ZIPS[@]} -gt 0 ]; then
    echo "   üì¶ –†–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞—é –∞—Ä—Ö–∏–≤—ã: ${DOWNLOADED_ZIPS[*]}"
    unzip -q "${DOWNLOADED_ZIPS[@]}" && rm -f "${DOWNLOADED_ZIPS[@]}"
    echo "‚úÖ –ü–ª–∞–≥–∏–Ω—ã —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã"
else
    echo "‚ö†Ô∏è  –í–ù–ò–ú–ê–ù–ò–ï: –ù–µ —Å–∫–∞—á–∞–Ω –Ω–∏ –æ–¥–∏–Ω –ø–ª–∞–≥–∏–Ω. –ü–∞–ø–∫–∞ plugins –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –ø—É—Å—Ç–æ–π."
fi

# 3. –£–°–¢–ê–ù–û–í–ö–ê –¢–ï–ú–´
echo "üé® –ö–ª–æ–Ω–∏—Ä—É—é —Ç–µ–º—É esalanding..."
cd ../../  # –í–ê–ñ–ù–û: –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –≤ –∫–æ—Ä–µ–Ω—å —Å–∞–π—Ç–∞
if [ -d "wp-content/themes" ]; then
    cd wp-content/themes/
    if git clone -q https://github.com/Jamelich/esalanding.git esalanding 2>/dev/null; then
        rm -rf esalanding/.git
        echo "‚úÖ –¢–µ–º–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞"
    else
        echo "‚ùå –û–®–ò–ë–ö–ê: –ù–µ —É–¥–∞–ª–æ—Å—å –∫–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–º—É esalanding"
        echo "   üí° –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø –∫ GitHub –∏–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —Å—Å—ã–ª–∫–∏"
    fi
else
    echo "‚ùå –û–®–ò–ë–ö–ê: –ü–∞–ø–∫–∞ wp-content/themes/ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"
fi

# 4. –§–ò–ù–ê–õ–¨–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê –ò –ò–ù–°–¢–†–£–ö–¶–ò–Ø
echo ""
echo "============================================="
echo "‚ú® –£–°–¢–ê–ù–û–í–ö–ê –ó–ê–í–ï–†–®–ï–ù–ê!"
echo "============================================="
cd ../../  # –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤–æ–∑–≤—Ä–∞—Ç –≤ –∫–æ—Ä–µ–Ω—å —Å–∞–π—Ç–∞
echo "–ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –ø–ª–∞–≥–∏–Ω–æ–≤:"
if [ -d "wp-content/plugins" ]; then
    ls -1 wp-content/plugins/
else
    echo "–ü–∞–ø–∫–∞ wp-content/plugins –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!"
fi

echo ""
echo "–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:"
echo "1. üìÇ –°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö MySQL —á–µ—Ä–µ–∑ –ø–∞–Ω–µ–ª—å —Ö–æ—Å—Ç–∏–Ω–≥–∞"
echo "2. üåê –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ –ø–æ –∞–¥—Ä–µ—Å—É –≤–∞—à–µ–≥–æ —Å–∞–π—Ç–∞"
echo "3. üîß –ó–∞–≤–µ—Ä—à–∏—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É WordPress —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å"
echo "4. ‚öôÔ∏è  –í –∞–¥–º–∏–Ω–∫–µ –∞–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –ø–ª–∞–≥–∏–Ω—ã –∏ —Ç–µ–º—É 'esalanding'"
echo ""
echo "–°–∫—Ä–∏–ø—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –¥–ª—è Jamelich (wp-langing-auto-setup)"
echo "============================================="
